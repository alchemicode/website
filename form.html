<!DOCTYPE html>
<html lang="en">

<head profile>
    <title>Code Alchemi</title>
    <link rel="icon" type="image/png" href="images/alchemi.png">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="glass">
        <div id="header">
            <a href="https://mail.codealchemi.com" id="header_link">
                <h1 id="header_text"><img src="images/alchemi.png" id="header_logo" height="80px" width="80px"></h1>
            </a>
            <div id="nav_links">
                <a href="index.html">Home</a>
                <a href="products.html">Portfolio</a>
                <a href="games.html">Games</a>
                <a href="pricing.html">Pricing</a>
            </div>
        </div>
    </div>
    <div style="text-align: center; padding-top: 10em; color: #fff;">
        <h2 class="content-header bottom-left-shadow">Book Consultation</h2>
        <div class="bottom-left-shadow" id="tbox"></div>
        <form name="consultation" id="theform">
            <label for="name" class="bottom-left-shadow">Name</label><br>
            <input type="text" id="name" name="name" required>
            <br>
            <label for="email" class="bottom-left-shadow">Email Address</label><br>
            <input type="text" id="email" name="email" required>
            <br>
            <label for="problem" class="bottom-left-shadow">What can we do for you</label><br>
            <textarea id="problem" name="message" rows="5" cols="50" wrap=soft required></textarea>
            <br>
            <input type="submit" value="Submit">
        </form>
        <div class="bottom-left-shadow">Or contact us directly at <a href="mailto:admin@codealchemi.com" class="email-link">admin@codealchemi.com</a></div>
    </div>
    <div id="copyright">
        Copyright (c) 2022, Codealchemi. All Rights Reserved.
    </div>
    <script>
        function handleSubmit(event) {
            event.preventDefault();

            const data = new FormData(event.target);

            const value = Object.fromEntries(data.entries());

            const value_json = JSON.stringify(value);

            console.log({
                value
            });

            var request = new XMLHttpRequest();
            
            request.onreadystatechange = function() {
                if (request.readyState == XMLHttpRequest.DONE) {
                    document.getElementById("theform").innerHTML = "";
                    if (request.responseText === "Handled.") {
                        document.getElementById("tbox").innerHTML = "Thanks for leaving us a message. We'll be in touch soon. :)";    
                    } else {
                        document.getElementById("tbox").innerHTML = "This is embarrasing, but something went wrong.";
                    }
                }
            }
            
            request.open("POST", "https://mail.codealchemi.com/form/");
            request.setRequestHeader('Content-Type', 'application/json');
            request.send(value_json);
            
            
        }

        const form = document.querySelector('form');
        form.addEventListener('submit', handleSubmit);
    </script>
</body>

</html>
